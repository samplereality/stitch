<!doctype html>
<html lang="en">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <title>Glitch-lite Editor</title>
    <link rel="stylesheet" href="assets/styles.css" />
    <link
      rel="stylesheet"
      href="https://cdn.jsdelivr.net/npm/codemirror@5.65.16/lib/codemirror.css"
    />
    <link
      rel="stylesheet"
      href="https://cdn.jsdelivr.net/npm/codemirror@5.65.16/theme/material-darker.css"
    />
    <link
      rel="stylesheet"
      href="https://cdn.jsdelivr.net/npm/codemirror@5.65.16/addon/fold/foldgutter.css"
    />
    <link
      rel="stylesheet"
      href="https://cdn.jsdelivr.net/npm/codemirror@5.65.16/addon/dialog/dialog.css"
    />
  </head>
  <body>
    <div class="app">
      <header class="topbar">
        <div class="brand">
          <div class="brand-mark"></div>
          <div class="brand-text">
            <span class="brand-title">Glitchlet</span>
            <span class="brand-subtitle">
              A Glitch-Like Tool for Creative Coding
              <button id="aboutBtn" class="icon-btn subtle-icon" title="About Glitchlet">
                <i data-lucide="heart-handshake"></i>
              </button>
            </span>
          </div>
        </div>
        <div class="current-project">
          <span class="current-project-label">Project</span>
          <div class="current-project-row">
            <span id="currentProjectName" class="current-project-name">Untitled Project</span>
            <button id="projectMetaBtn" class="meta-btn" title="Edit project details">
              <i data-lucide="pencil"></i>
            </button>
          </div>
        </div>
        <div class="actions">
          <button id="themeToggleBtn" class="icon-btn" title="Switch theme mode">
            <i data-lucide="sun-moon"></i>
          </button>
          <a class="btn" href="https://glitchlet.digitaldavidson.net/projects/" target="_blank" rel="noopener">Published Projects</a>
          <div class="project-manager">
            <button id="projectManagerBtn" class="btn" title="Open project manager">Projects</button>
            <div id="projectManagerPanel" class="manager-panel hidden" role="dialog" aria-label="Project manager">
              <div class="manager-header">
                <span>Project Manager</span>
                <button id="closeProjectManagerBtn" class="icon-btn" title="Close">
                  <i data-lucide="x"></i>
                </button>
              </div>
              <div class="manager-section">
                <label class="manager-label" for="projectNameInput">Current project name</label>
                <div class="manager-row">
                  <input id="projectNameInput" class="manager-input" type="text" placeholder="Untitled Project" />
                  <button id="renameProjectBtn" class="btn">Rename</button>
                </div>
                <div class="manager-row">
                  <button id="saveProjectBtn" class="btn">Save</button>
                  <button id="saveProjectAsBtn" class="btn">Save As...</button>
                  <button id="newProjectBtn" class="btn">New Project</button>
                </div>
              </div>
              <div class="manager-section">
                <div class="manager-label">Projects</div>
                <div id="projectList" class="project-list"></div>
              </div>
              <div class="manager-section">
                <div class="manager-label">Import / Export</div>
                <div class="manager-row">
                  <button id="importZipBtn" class="btn">Import ZIP</button>
                  <button id="exportZipBtn" class="btn">Export ZIP</button>
                </div>
              </div>
            </div>
          </div>
          <button id="publishBtn" class="btn btn-primary">Publish</button>
        </div>
      </header>

      <main class="workspace" id="workspace">
        <aside class="panel file-panel">
          <div class="panel-header">
            <span>Files</span>
            <div class="panel-actions">
              <button id="toggleFilePanelBtn" class="icon-btn" title="Collapse files">
                <i data-lucide="chevrons-left"></i>
              </button>
              <button id="addFolderBtn" class="icon-btn" title="New folder">
                <i data-lucide="folder-plus"></i>
              </button>
              <button id="addFileBtn" class="icon-btn" title="Add file">
                <i data-lucide="file-plus"></i>
              </button>
              <button id="uploadFileBtn" class="icon-btn" title="Upload files">
                <i data-lucide="upload"></i>
              </button>
            </div>
          </div>
          <div id="fileTree" class="file-tree"></div>
        </aside>

        <section class="panel editor-panel">
          <div class="panel-header">
            <div class="panel-title">
              <span id="currentFileLabel">Select a file</span>
              <span id="saveStatus" class="status"></span>
            </div>
            <div class="panel-actions">
              <button id="expandFilePanelBtn" class="icon-btn hidden" title="Show files">
                <i data-lucide="folder-open"></i>
              </button>
              <button id="undoBtn" class="icon-btn" title="Undo last change">
                <i data-lucide="undo-2"></i>
              </button>
              <button id="redoBtn" class="icon-btn" title="Redo last change">
                <i data-lucide="redo-2"></i>
              </button>
              <button id="wrapToggleBtn" class="icon-btn" title="Toggle line wrap">
                <i data-lucide="wrap-text"></i>
              </button>
              <button id="searchBtn" class="icon-btn" title="Search">
                <i data-lucide="search"></i>
              </button>
              <button id="foldAllBtn" class="icon-btn" title="Fold all">
                <i data-lucide="fold-vertical"></i>
              </button>
              <button id="unfoldAllBtn" class="icon-btn" title="Unfold all">
                <i data-lucide="unfold-vertical"></i>
              </button>
              <button id="prettifyBtn" class="icon-btn" title="Format current file">
                <i data-lucide="wand-2"></i>
              </button>
              <button id="editorThemeToggleBtn" class="icon-btn" title="Toggle editor theme">
                <i data-lucide="moon-star"></i>
              </button>
            </div>
          </div>
          <div class="editor-wrap">
            <textarea id="editor" class="editor" spellcheck="false"></textarea>
            <div id="binaryNotice" class="binary-notice hidden">
              This file is binary. Preview it in the right panel or replace it.
            </div>
          </div>
        </section>

        <div class="splitter" id="editorPreviewSplitter" role="separator" aria-label="Resize editor"></div>

        <section class="panel preview-panel">
          <div class="panel-header">
            <span>Preview</span>
            <div class="panel-actions">
              <button id="refreshPreviewBtn" class="icon-btn" title="Refresh preview">
                <i data-lucide="refresh-cw"></i>
              </button>
            </div>
          </div>
          <div class="preview-wrap">
            <iframe
              id="previewFrame"
              sandbox="allow-scripts allow-same-origin"
              title="Project Preview"
            ></iframe>
          </div>
          <div id="previewWarnings" class="warnings"></div>
        </section>
      </main>
    </div>

    <input id="zipInput" type="file" accept=".zip,.tgz,.tar.gz" class="hidden" />
    <input id="fileInput" type="file" multiple class="hidden" />

    <div id="newProjectModal" class="modal hidden" role="dialog" aria-label="New project">
      <div class="modal-backdrop"></div>
      <div class="modal-panel">
        <div class="modal-header">
          <span>New project</span>
          <button id="closeNewProjectBtn" class="icon-btn" title="Close">
            <i data-lucide="x"></i>
          </button>
        </div>
        <div class="modal-body">
          <label class="modal-label" for="newProjectNameInput">Project name</label>
          <input id="newProjectNameInput" class="modal-input" type="text" placeholder="Project name" />
          <label class="modal-label checkbox-row">
            <input id="includeStarterFilesInput" type="checkbox" checked />
            Include starter files
          </label>
        </div>
        <div class="modal-actions">
          <button id="createProjectBtn" class="btn btn-primary">Create</button>
        </div>
      </div>
    </div>

        <div id="projectMetaModal" class="modal hidden" role="dialog" aria-label="Project details">
          <div class="modal-backdrop"></div>
          <div class="modal-panel">
            <div class="modal-header">
              <span>Project details</span>
              <button id="closeProjectMetaBtn" class="icon-btn" title="Close">
                <i data-lucide="x"></i>
              </button>
            </div>
            <div class="modal-body">
              <label class="modal-label" for="projectTitleInput">Project name</label>
              <input id="projectTitleInput" class="modal-input" type="text" placeholder="Project name" />
              <label class="modal-label" for="projectCreatorInput">Creator name</label>
              <input id="projectCreatorInput" class="modal-input" type="text" placeholder="Your name" />
              <label class="modal-label" for="projectDescriptionInput">Project description</label>
              <textarea id="projectDescriptionInput" class="modal-textarea" placeholder="Short description"></textarea>
            </div>
        <div class="modal-actions">
          <button id="saveProjectMetaBtn" class="btn">Save</button>
        </div>
      </div>
    </div>

    <div id="publishModal" class="modal hidden" role="dialog" aria-label="Publish complete">
      <div class="modal-backdrop"></div>
      <div class="modal-panel">
        <div class="modal-header">
          <span>Published</span>
          <button id="closePublishModalBtn" class="icon-btn" title="Close">
            <i data-lucide="x"></i>
          </button>
        </div>
        <div class="modal-body">
          <p class="modal-text">Your project is live at:</p>
          <div class="modal-url" id="publishUrlText"></div>
          <div id="publishPasswordBlock" class="modal-password hidden">
            <p class="modal-text">Admin password for this project (copy now):</p>
            <div class="modal-url" id="publishPasswordText"></div>
            <button id="copyPublishPasswordBtn" class="btn">Copy password</button>
          </div>
        </div>
        <div class="modal-actions">
          <button id="copyPublishUrlBtn" class="btn">Copy URL</button>
          <button id="openPublishUrlBtn" class="btn btn-primary">Open</button>
        </div>
      </div>
    </div>

    <div id="dialogModal" class="modal hidden" role="dialog" aria-label="Dialog">
      <div class="modal-backdrop"></div>
      <div class="modal-panel">
        <div class="modal-header">
          <span id="dialogTitle">Notice</span>
          <button id="dialogCloseBtn" class="icon-btn" title="Close">
            <i data-lucide="x"></i>
          </button>
        </div>
        <div class="modal-body">
          <p id="dialogMessage" class="modal-text"></p>
          <input id="dialogInput" class="modal-input hidden" type="text" />
        </div>
        <div class="modal-actions">
          <button id="dialogCancelBtn" class="btn">Cancel</button>
          <button id="dialogOkBtn" class="btn btn-primary">OK</button>
        </div>
      </div>
    </div>

    <div id="aboutModal" class="modal hidden" role="dialog" aria-label="About Glitchlet">
      <div class="modal-backdrop"></div>
      <div class="modal-panel">
        <div class="modal-header">
          <span>About Glitchlet</span>
          <button id="closeAboutBtn" class="icon-btn" title="Close">
            <i data-lucide="x"></i>
          </button>
        </div>
        <div class="modal-body">
          <p class="modal-text">
            Glitchlet is a lightweight, browser-based creative coding environment for building
            small HTML/CSS/JS projects with instant preview.
          </p>
          <p class="modal-text">
            Created by Mark Sample to help students and hobbyists publish and remix web projects.
          </p>
          <p class="modal-text">
            Source: <a class="modal-link" href="https://github.com/samplereality/glitchlet/" target="_blank" rel="noopener">github.com/samplereality/glitchlet</a>
          </p>
        </div>
        <div class="modal-actions">
          <button id="dismissAboutBtn" class="btn btn-primary">Got it</button>
        </div>
      </div>
    </div>

    <script src="https://cdn.jsdelivr.net/npm/codemirror@5.65.16/lib/codemirror.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/codemirror@5.65.16/mode/xml/xml.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/codemirror@5.65.16/mode/javascript/javascript.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/codemirror@5.65.16/mode/css/css.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/codemirror@5.65.16/mode/htmlmixed/htmlmixed.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/codemirror@5.65.16/addon/edit/matchbrackets.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/codemirror@5.65.16/addon/edit/closebrackets.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/codemirror@5.65.16/addon/edit/closetag.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/codemirror@5.65.16/addon/fold/foldcode.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/codemirror@5.65.16/addon/fold/foldgutter.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/codemirror@5.65.16/addon/fold/brace-fold.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/codemirror@5.65.16/addon/fold/indent-fold.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/codemirror@5.65.16/addon/fold/comment-fold.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/codemirror@5.65.16/addon/fold/xml-fold.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/codemirror@5.65.16/addon/fold/markdown-fold.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/codemirror@5.65.16/addon/fold/javascript-fold.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/codemirror@5.65.16/addon/search/searchcursor.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/codemirror@5.65.16/addon/search/search.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/codemirror@5.65.16/addon/dialog/dialog.js"></script>
    <script src="https://unpkg.com/prettier@3.8.0/standalone.js"></script>
    <script src="https://unpkg.com/prettier@3.8.0/plugins/babel.js"></script>
    <script src="https://unpkg.com/prettier@3.8.0/plugins/estree.js"></script>
    <script src="https://unpkg.com/prettier@3.8.0/plugins/html.js"></script>
    <script src="https://unpkg.com/prettier@3.8.0/plugins/postcss.js"></script>
    <script src="https://unpkg.com/lucide@latest"></script>
    <script src="assets/app.js"></script>
  </body>
</html>
