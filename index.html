<!doctype html>
<html lang="en">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <title>Glitch-lite Editor</title>
    <link rel="stylesheet" href="assets/styles.css" />
    <link
      rel="stylesheet"
      href="https://cdn.jsdelivr.net/npm/codemirror@5.65.16/lib/codemirror.css"
    />
    <link
      rel="stylesheet"
      href="https://cdn.jsdelivr.net/npm/codemirror@5.65.16/theme/material-darker.css"
    />
  </head>
  <body>
    <div class="app">
      <header class="topbar">
        <div class="brand">
          <div class="brand-mark"></div>
          <div class="brand-text">
            <span class="brand-title">Glitchlet</span>
            <span class="brand-subtitle">A Glitch-Like Tool for Creative Coding</span>
          </div>
        </div>
        <div class="current-project">
          <span class="current-project-label">Project</span>
          <div class="current-project-row">
            <span id="currentProjectName" class="current-project-name">Untitled Project</span>
            <button id="projectMetaBtn" class="meta-btn" title="Edit project details">
              <i data-lucide="pencil"></i>
            </button>
          </div>
        </div>
        <div class="actions">
          <button id="themeToggleBtn" class="icon-btn" title="Switch theme mode">
            <i data-lucide="sun-moon"></i>
          </button>
          <div class="project-manager">
            <button id="projectManagerBtn" class="btn" title="Open project manager">Projects</button>
            <div id="projectManagerPanel" class="manager-panel hidden" role="dialog" aria-label="Project manager">
              <div class="manager-header">
                <span>Project Manager</span>
                <button id="closeProjectManagerBtn" class="icon-btn" title="Close">
                  <i data-lucide="x"></i>
                </button>
              </div>
              <div class="manager-section">
                <label class="manager-label" for="projectNameInput">Current project name</label>
                <div class="manager-row">
                  <input id="projectNameInput" class="manager-input" type="text" placeholder="Untitled Project" />
                  <button id="renameProjectBtn" class="btn">Rename</button>
                </div>
                <div class="manager-row">
                  <button id="saveProjectBtn" class="btn">Save</button>
                  <button id="saveProjectAsBtn" class="btn">Save As...</button>
                  <button id="newProjectBtn" class="btn">New Project</button>
                </div>
              </div>
              <div class="manager-section">
                <div class="manager-label">Projects</div>
                <div id="projectList" class="project-list"></div>
              </div>
              <div class="manager-section">
                <div class="manager-label">Import / Export</div>
                <div class="manager-row">
                  <button id="importZipBtn" class="btn">Import ZIP</button>
                  <button id="exportZipBtn" class="btn">Export ZIP</button>
                </div>
              </div>
            </div>
          </div>
          <button id="publishBtn" class="btn btn-primary">Publish</button>
        </div>
      </header>

      <main class="workspace" id="workspace">
        <aside class="panel file-panel">
          <div class="panel-header">
            <span>Files</span>
            <div class="panel-actions">
              <button id="toggleFilePanelBtn" class="icon-btn" title="Collapse files">
                <i data-lucide="chevrons-left"></i>
              </button>
              <button id="addFileBtn" class="icon-btn" title="Add file">
                <i data-lucide="file-plus"></i>
              </button>
              <button id="uploadFileBtn" class="icon-btn" title="Upload files">
                <i data-lucide="upload"></i>
              </button>
            </div>
          </div>
          <div id="fileTree" class="file-tree"></div>
        </aside>

        <section class="panel editor-panel">
          <div class="panel-header">
            <div class="panel-title">
              <span id="currentFileLabel">Select a file</span>
              <span id="saveStatus" class="status"></span>
            </div>
            <div class="panel-actions">
              <button id="expandFilePanelBtn" class="icon-btn hidden" title="Show files">
                <i data-lucide="folder-open"></i>
              </button>
              <button id="undoBtn" class="icon-btn" title="Undo last change">
                <i data-lucide="undo-2"></i>
              </button>
              <button id="redoBtn" class="icon-btn" title="Redo last change">
                <i data-lucide="redo-2"></i>
              </button>
              <button id="prettifyBtn" class="icon-btn" title="Format current file">
                <i data-lucide="wand-2"></i>
              </button>
              <button id="editorThemeToggleBtn" class="icon-btn" title="Toggle editor theme">
                <i data-lucide="moon-star"></i>
              </button>
            </div>
          </div>
          <div class="editor-wrap">
            <textarea id="editor" class="editor" spellcheck="false"></textarea>
            <div id="binaryNotice" class="binary-notice hidden">
              This file is binary. Preview it in the right panel or replace it.
            </div>
          </div>
        </section>

        <div class="splitter" id="editorPreviewSplitter" role="separator" aria-label="Resize editor"></div>

        <section class="panel preview-panel">
          <div class="panel-header">
            <span>Preview</span>
            <div class="panel-actions">
              <button id="refreshPreviewBtn" class="icon-btn" title="Refresh preview">
                <i data-lucide="refresh-cw"></i>
              </button>
            </div>
          </div>
          <div class="preview-wrap">
            <iframe
              id="previewFrame"
              sandbox="allow-scripts allow-same-origin"
              title="Project Preview"
            ></iframe>
          </div>
          <div id="previewWarnings" class="warnings"></div>
        </section>
      </main>
    </div>

    <input id="zipInput" type="file" accept=".zip" class="hidden" />
    <input id="fileInput" type="file" multiple class="hidden" />

    <div id="projectMetaModal" class="modal hidden" role="dialog" aria-label="Project details">
      <div class="modal-backdrop"></div>
      <div class="modal-panel">
        <div class="modal-header">
          <span>Project details</span>
          <button id="closeProjectMetaBtn" class="icon-btn" title="Close">
            <i data-lucide="x"></i>
          </button>
        </div>
        <div class="modal-body">
          <label class="modal-label" for="projectCreatorInput">Creator name</label>
          <input id="projectCreatorInput" class="modal-input" type="text" placeholder="Your name" />
          <label class="modal-label" for="projectDescriptionInput">Project description</label>
          <textarea id="projectDescriptionInput" class="modal-textarea" placeholder="Short description"></textarea>
        </div>
        <div class="modal-actions">
          <button id="saveProjectMetaBtn" class="btn">Save</button>
        </div>
      </div>
    </div>

    <div id="publishModal" class="modal hidden" role="dialog" aria-label="Publish complete">
      <div class="modal-backdrop"></div>
      <div class="modal-panel">
        <div class="modal-header">
          <span>Published</span>
          <button id="closePublishModalBtn" class="icon-btn" title="Close">
            <i data-lucide="x"></i>
          </button>
        </div>
        <div class="modal-body">
          <p class="modal-text">Your project is live at:</p>
          <div class="modal-url" id="publishUrlText"></div>
        </div>
        <div class="modal-actions">
          <button id="copyPublishUrlBtn" class="btn">Copy URL</button>
          <button id="openPublishUrlBtn" class="btn btn-primary">Open</button>
        </div>
      </div>
    </div>

    <script src="https://cdn.jsdelivr.net/npm/codemirror@5.65.16/lib/codemirror.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/codemirror@5.65.16/mode/xml/xml.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/codemirror@5.65.16/mode/javascript/javascript.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/codemirror@5.65.16/mode/css/css.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/codemirror@5.65.16/mode/htmlmixed/htmlmixed.js"></script>
    <script src="https://unpkg.com/prettier@3.8.0/standalone.js"></script>
    <script src="https://unpkg.com/prettier@3.8.0/plugins/babel.js"></script>
    <script src="https://unpkg.com/prettier@3.8.0/plugins/estree.js"></script>
    <script src="https://unpkg.com/prettier@3.8.0/plugins/html.js"></script>
    <script src="https://unpkg.com/prettier@3.8.0/plugins/postcss.js"></script>
    <script src="https://unpkg.com/lucide@latest"></script>
    <script src="assets/app.js"></script>
  </body>
</html>
